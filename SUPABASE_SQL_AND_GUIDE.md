# Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Supabase ðŸš€

Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§ Ø´Ø§Ù…Ù„ Ú©Ø¯Ù‡Ø§ÛŒ SQL Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ… Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø´Ù…Ø§ Ø¯Ø± Supabase Ùˆ Ù†Ø­ÙˆÙ‡ Ú©Ø§Ø±Ú©Ø±Ø¯ Ø¢Ù† Ø§Ø³Øª.

## Û±. Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø¯Ù‡Ø§ÛŒ SQL Ø¯Ø± Supabase

Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆØ¯ØŒ Ø¨Ø§ÛŒØ¯ ÛŒÚ© Ø¬Ø¯ÙˆÙ„ `profiles` Ø¨Ø³Ø§Ø²ÛŒÙ… Ú©Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø§ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù‡Ø± Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª (Auth) SupabaseØŒ ÛŒÚ© Ø±Ú©ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯ Ø¯Ø± Ø¢Ù† Ø§ÛŒØ¬Ø§Ø¯ Ø´ÙˆØ¯.

Û±. ÙˆØ§Ø±Ø¯ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Supabase Ø®ÙˆØ¯ Ø´ÙˆÛŒØ¯ (Ù¾Ø±ÙˆÚ˜Ù‡ `zwyiytobtejfpizycnam`).
Û². Ø§Ø² Ù…Ù†ÙˆÛŒ Ø³Ù…Øª Ú†Ù¾ØŒ Ø¨Ù‡ Ø¨Ø®Ø´ **SQL Editor** Ø¨Ø±ÙˆÛŒØ¯.
Û³. Ø±ÙˆÛŒ **New Query** Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.
Û´. Ú©Ø¯Ù‡Ø§ÛŒ SQL Ø²ÛŒØ± Ø±Ø§ Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯:

```sql
-- Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ profiles Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¹Ù…ÙˆÙ…ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
create table public.profiles (
  id uuid references auth.users on delete cascade not null primary key,
  name text,
  email text,
  phone text,
  address text,
  city text,
  province text,
  bio text,
  avatar_url text,
  tron_wallet text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Row Level Security (RLS) Ø¨Ø±Ø§ÛŒ Ø§Ù…Ù†ÛŒØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
alter table public.profiles enable row level security;

-- Ø§ÛŒØ¬Ø§Ø¯ Policy: Ù‡Ø±Ú©Ø³ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù¾Ø±ÙˆÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ Ø±Ø§ Ø¨Ø¨ÛŒÙ†Ø¯ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
create policy "Public profiles are viewable by everyone." on public.profiles
  for select using (true);

-- Ø§ÛŒØ¬Ø§Ø¯ Policy: Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙÙ‚Ø· Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø®ÙˆØ¯Ø´Ø§Ù† Ø±Ø§ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†Ù†Ø¯
create policy "Users can update own profile." on public.profiles
  for update using (auth.uid() = id);

-- Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© ØªØ§Ø¨Ø¹ (Function) Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ Ø¬Ø¯ÙˆÙ„ profiles
create function public.handle_new_user()
returns trigger as $$
begin
  insert into public.profiles (id, name, email)
  values (new.id, new.raw_user_meta_data->>'name', new.email);
  return new;
end;
$$ language plpgsql security definer;

-- Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© Trigger Ú©Ù‡ ØªØ§Ø¨Ø¹ Ø¨Ø§Ù„Ø§ Ø±Ø§ Ù¾Ø³ Ø§Ø² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù‡Ø± Ú©Ø§Ø±Ø¨Ø± ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();
```

Ûµ. Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ **Run** Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ú©Ø¯Ù‡Ø§ Ø§Ø¬Ø±Ø§ Ø´ÙˆÙ†Ø¯. Ø¨Ø§ Ø§ÛŒÙ† Ú©Ø§Ø± Ø¬Ø¯ÙˆÙ„ `profiles` Ùˆ ØªØ±ÛŒÚ¯Ø±Ù‡Ø§ÛŒ Ù„Ø§Ø²Ù… Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.

## Û². ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØ§ÛŒÛŒØ¯ Ø§ÛŒÙ…ÛŒÙ„ (Email Confirmation)

Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ØŒ Supabase Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ§ÛŒÛŒØ¯ Ø§ÛŒÙ…ÛŒÙ„ Ø¯Ø§Ø±Ø¯. Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ Ù¾Ø³ Ø§Ø² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… ÙˆØ§Ø±Ø¯ Ø´ÙˆÙ†Ø¯ (Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù„ÛŒÙ†Ú© ØªØ§ÛŒÛŒØ¯ Ø¯Ø± Ø§ÛŒÙ…ÛŒÙ„):

Û±. Ø¯Ø± Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Supabase Ø¨Ù‡ Ø¨Ø®Ø´ **Authentication** Ø¨Ø±ÙˆÛŒØ¯.
Û². Ø±ÙˆÛŒ **Providers** Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ Ùˆ **Email** Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.
Û³. Ú¯Ø²ÛŒÙ†Ù‡ **Confirm email** Ø±Ø§ Ø®Ø§Ù…ÙˆØ´ (Disable) Ú©Ù†ÛŒØ¯.
Û´. Ø±ÙˆÛŒ **Save** Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.

## Û³. Ù†Ø­ÙˆÙ‡ Ú©Ø§Ø±Ú©Ø±Ø¯ Ø¨Ø±Ù†Ø§Ù…Ù‡

Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø´Ù…Ø§ Ø§Ú©Ù†ÙˆÙ† Ø¨Ù‡ ØµÙˆØ±Øª Ú©Ø§Ù…Ù„ Ø¨Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡ Supabase Ø´Ù…Ø§ Ù…ØªØµÙ„ Ø´Ø¯Ù‡ Ø§Ø³Øª.

### ÙØ±Ø¢ÛŒÙ†Ø¯Ù‡Ø§:
- **Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…:** ÙˆÙ‚ØªÛŒ Ú©Ø§Ø±Ø¨Ø±ÛŒ ÙØ±Ù… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø±Ø§ Ù¾Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ùˆ (Ø§ÛŒÙ…ÛŒÙ„ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±) Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ù†Ø§Ù… Ø¨Ù‡ Supabase Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø³Ù¾Ø³ ØªØ±ÛŒÚ¯Ø± SQL Ú©Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø±Ø¯ÛŒØ¯ØŒ Ù†Ø§Ù… Ùˆ Ø§ÛŒÙ…ÛŒÙ„ Ø§Ùˆ Ø±Ø§ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ `profiles` Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
- **ÙˆØ±ÙˆØ¯:** ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø§ÛŒÙ…ÛŒÙ„ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø³Ø±ÙˆÛŒØ³ Auth Ø³ÙˆÙ¾Ø§Ø¨ÛŒØ³ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯.
- **Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ú©Ø§Ø±Ø¨Ø±ÛŒ:** Ù¾Ø³ Ø§Ø² ÙˆØ±ÙˆØ¯ØŒ Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ù¾Ù†Ù„ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù…Ø¯Ø±Ù† Ø®ÙˆØ¯ Ù‡Ø¯Ø§ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¯Ø± Ø¢Ù†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§Ø·Ù„Ø§Ø¹Ø§ØªÛŒ Ù…Ø§Ù†Ù†Ø¯ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†ØŒ Ø¢Ø¯Ø±Ø³ØŒ Ø´Ù‡Ø±ØŒ Ø§Ø³ØªØ§Ù†ØŒ Ø¨Ø§ÛŒÙˆØŒ Ø¹Ú©Ø³ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ùˆ Ø¢Ø¯Ø±Ø³ Ú©ÛŒÙ Ù¾ÙˆÙ„ ØªØ±ÙˆÙ† (TRX) Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†Ø¯. Ø§ÛŒÙ† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ `profiles` Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.
- **Ù†Ø´Ø³Øª (Session):** ÙˆØ¶Ø¹ÛŒØª ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ø¨Ø§ Ø±ÙØ±Ø´ Ú©Ø±Ø¯Ù† ØµÙØ­Ù‡ Ø§Ø² Ø¨ÛŒÙ† Ù†Ù…ÛŒâ€ŒØ±ÙˆØ¯.

Ø§Ú©Ù†ÙˆÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±Ø§ ØªØ³Øª Ú©Ù†ÛŒØ¯ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¬Ø¯ÛŒØ¯ÛŒ Ø¨Ø³Ø§Ø²ÛŒØ¯! Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¢Ù†â€ŒÙ‡Ø§ Ø¯Ø± Ø¨Ø®Ø´ **Table Editor** > `profiles` Ùˆ Ù‡Ù…Ú†Ù†ÛŒÙ† **Authentication** > `Users` Ø¯Ø± Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Supabase Ø´Ù…Ø§ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯.
